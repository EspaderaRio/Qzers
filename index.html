<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flashcard Study App</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2563eb">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="mobile-web-app-capable" content="yes">
<link rel="stylesheet" href="styles.css">
<script>
(function () {
  var config = {};

  window.elementSdk = {
    init: function (api) {
      
      if (api && api.defaultConfig) {
        config = Object.assign({}, api.defaultConfig);
      } else {
        config = {};
      }

    
      window.__elementApi = api;
    },

    setConfig: function (newConfig) {
      config = Object.assign({}, config, newConfig);

      
      if (
        window.__elementApi &&
        typeof window.__elementApi.onConfigChange === "function"
      ) {
        window.__elementApi.onConfigChange(config);
      }
    },

    getConfig: function () {
      return Object.assign({}, config);
    }
  };
})();
</script>

<script>
(function () {


window.getUser = function () {
  return JSON.parse(localStorage.getItem("user"));
};

window.setUser = function (user) {
  localStorage.setItem("user", JSON.stringify(user));
};

window.logoutUser = function () {
  localStorage.removeItem("user");
};

if (!getUser()) {
  const role = prompt("Enter role: teacher or student", "student");

  setUser({
    id: crypto.randomUUID(),
    role: role === "teacher" ? "teacher" : "student",
    name: role === "teacher" ? "Teacher Demo" : "Student Demo"
  });
}

  function getStorageKey() {
    const user = getUser();
    return user ? `flashcards_${user.id}` : "flashcards_guest";
  }

  var handler = null;
  var data = [];

  function load() {
    try {
      var stored = localStorage.getItem(getStorageKey());
      data = stored ? JSON.parse(stored) : [];
    } catch {
      data = [];
    }
  }

  function save() {
    localStorage.setItem(getStorageKey(), JSON.stringify(data));
  }

  function notify() {
    if (handler && typeof handler.onDataChanged === "function") {
      handler.onDataChanged(data.slice());
    }
  }

  function generateId() {
    return (
      "id_" +
      Date.now() +
      "_" +
      Math.random().toString(36).slice(2, 8)
    );
  }

  window.dataSdk = {
    init: function (h) {
      handler = h;
      load();
      notify();
      return Promise.resolve({ isOk: true });
    },

    create: function (item) {
      var newItem = Object.assign({}, item, {
        id: generateId()
      });

      data.push(newItem);
      save();
      notify();

      return Promise.resolve({ isOk: true, item: newItem });
    },

    delete: function (opts, silent) {
      if (!opts || !opts.id) {
        return Promise.resolve({ isOk: false });
      }

      data = data.filter(d => d.id !== opts.id);
      save();
      if (!silent) notify();

      return Promise.resolve({ isOk: true });
    },

    update: function (updatedItem) {
      if (!updatedItem || !updatedItem.id) {
        return Promise.resolve({ isOk: false });
      }

      data = data.map(d =>
        d.id === updatedItem.id ? updatedItem : d
      );

      save();
      notify();

      return Promise.resolve({ isOk: true });
    },

    getAll: function () {
      return data.slice();
    }
  };

})();
</script>

  <script src="tailwindcss.js"></script>

  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="h-full">
  <div id="app" class="h-full w-full"></div>
    <div id="aiLoading" class="loading-overlay">
  <div class="loading"></div>
</div>
   <script src="app.js"></script>

<button id="openSettingsBtn" class="settings-fab">
  <img src="icons/settings.svg" class="icon md" alt="settings" />
</button>
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('./sw.js');
}
</script>

 </body>
 </html>
